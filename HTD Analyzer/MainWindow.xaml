<Window x:Class="HiddenTextDetector.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Hidden Text Detector"
        Height="800"
        Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#4A90E2">

    <Grid Background="#4A90E2">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Top Bar -->
        <StackPanel Grid.Row="0" Orientation="Vertical" Background="#4A90E2">
            <Grid Margin="20,15,20,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" FontSize="20" FontWeight="Bold" Foreground="White" VerticalAlignment="Center">Hidden Text Detector</TextBlock>
                <Button Grid.Column="1" Content="ℹ️ Impressum" Click="ImpressionButton_Click" Background="Transparent" Foreground="White" BorderThickness="0" FontSize="12" Cursor="Hand"/>
            </Grid>

            <Grid Margin="20,0,20,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBox x:Name="FilePathTextBox" Grid.Column="0" Margin="0,0,10,0" IsReadOnly="True" Text="Select a file..." Foreground="#999999" Background="#E8E8E8" Padding="8"/>
                <Button Grid.Column="1" Content="Browse" Click="BrowseButton_Click" Margin="0,0,10,0" Background="#D3D3D3" Foreground="#333333" Padding="10,5" FontWeight="Medium"/>
                <Button Grid.Column="2" x:Name="AnalyzeButton" Content="Analyze" Click="AnalyzeButton_Click" Margin="0,0,10,0" Background="#4A90E2" Foreground="White" Padding="15,5" IsEnabled="False" FontWeight="Medium"/>
                <Button Grid.Column="3" x:Name="NewDocumentButton" Content="New Document" Click="NewDocumentButton_Click" Background="#D3D3D3" Foreground="#333333" Padding="10,5" IsEnabled="False" FontWeight="Medium"/>
            </Grid>
        </StackPanel>

        <!-- Filter Bar -->
        <StackPanel Grid.Row="1" Orientation="Vertical" Background="#4A90E2">
            <TextBlock FontSize="11" FontWeight="Bold" Margin="20,10,10,5" Foreground="White">Filters</TextBlock>
            <Grid Margin="20,0,20,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>

                <ComboBox Grid.Column="0" x:Name="HiddenReasonFilter" Margin="0,0,10,0" SelectionChanged="Filter_Changed" Background="#E8E8E8" Foreground="#333333">
                    <ComboBoxItem IsSelected="True">All Reasons</ComboBoxItem>
                    <ComboBoxItem>White text</ComboBoxItem>
                    <ComboBoxItem>Micro font</ComboBoxItem>
                    <ComboBoxItem>Hidden attribute</ComboBoxItem>
                    <ComboBoxItem>Light color</ComboBoxItem>
                </ComboBox>

                <ComboBox Grid.Column="1" x:Name="FileTypeFilter" Margin="0,0,10,0" SelectionChanged="Filter_Changed" Background="#E8E8E8" Foreground="#333333">
                    <ComboBoxItem IsSelected="True">All Types</ComboBoxItem>
                    <ComboBoxItem>PDF</ComboBoxItem>
                    <ComboBoxItem>DOCX</ComboBoxItem>
                    <ComboBoxItem>Excel</ComboBoxItem>
                </ComboBox>

                <TextBox Grid.Column="2" x:Name="SearchTextBox" Margin="0,0,10,0" TextChanged="SearchTextBox_TextChanged" Background="#E8E8E8" Foreground="#333333" Padding="8"/>

                <Button Grid.Column="3" Content="Clear" Click="ClearFilters_Click" Background="#D3D3D3" Foreground="#333333" FontWeight="Medium"/>
            </Grid>
        </StackPanel>

        <!-- Main Content -->
        <Grid Grid.Row="2" Margin="20" Background="#FFFFFF">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="250"/>
            </Grid.ColumnDefinitions>

            <!-- DataGrid -->
            <DataGrid Grid.Column="0" x:Name="FindingsDataGrid" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True" Margin="0,0,10,0" Background="White" Foreground="#333333">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Location" Width="120" Binding="{Binding Location}"/>
                    <DataGridTextColumn Header="Text" Width="200" Binding="{Binding Text}"/>
                    <DataGridTextColumn Header="Font" Width="80" Binding="{Binding FontName}"/>
                    <DataGridTextColumn Header="Size" Width="50" Binding="{Binding FontSize}"/>
                    <DataGridTextColumn Header="Color" Width="100" Binding="{Binding ColorRgb}"/>
                    <DataGridTextColumn Header="Hidden Reason" Width="*" Binding="{Binding HiddenReasonsJoined}"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Statistics Panel -->
            <StackPanel Grid.Column="1" Background="#E8E8E8" Margin="0,0,0,0">
                <TextBlock FontSize="12" FontWeight="Bold" Margin="10,10,10,10" Foreground="#333333">Statistics</TextBlock>
                <TextBlock FontSize="10" Foreground="#666666" Margin="10,0,10,5">TOTAL FINDINGS</TextBlock>
                <TextBlock x:Name="TotalFindingsValue" FontSize="20" FontWeight="Bold" Margin="10,0,10,15" Foreground="#4A90E2">0</TextBlock>

                <TextBlock FontSize="11" FontWeight="Bold" Margin="10,10,10,5" Foreground="#333333">By Reason:</TextBlock>
                <ItemsControl x:Name="ReasonStatsControl" Margin="10,0,10,0">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="0,3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="35"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="{Binding Reason}" FontSize="10" Foreground="#333333"/>
                                <TextBlock Grid.Column="1" Text="{Binding Count}" FontWeight="Bold" TextAlignment="Right" Foreground="#4A90E2"/>
                            </Grid>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Grid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="3" Background="#D3D3D3">
            <TextBlock x:Name="StatusTextBlock" Margin="10,0,0,0" Foreground="#333333">Ready</TextBlock>
            <StatusBarItem HorizontalAlignment="Right">
                <Button x:Name="ExportButton" Content="Export CSV" Click="ExportButton_Click" Background="Transparent" Foreground="#4A90E2" BorderThickness="0" IsEnabled="False" FontWeight="Medium"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
